/** * DudoLib - Dirchs user defined object library * Copyright (C) 1994-2012 Dirk Klemmt * * This program is free software: you can redistribute it and/or * modify it under the terms of the GNU Lesser General Public * License as published by the Free Software Foundation, either * version 3 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, * but WITHOUT ANY WARRANTY; without even the implied warranty of * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the * GNU Lesser General Public License for more details. * * You should have received a copy of the GNU Lesser General Public * License along with this program. If not, see * <http://www.gnu.org/licenses/>. * * @copyright  Dirk Klemmt 1994-2012 * @author     Dirk Klemmt * @license    LGPL */#include <string.h>#include "..\include\dudolib.h"#if 0/** * Mit dieser Methode wird eine Karteikarte getoppt. * * @param *card Zeiger auf die Struktur der Karteikarten * @param head Objekt-Index des Reiters, dessen zugehoerige Karteikarte angezeigt werden soll * @param redraw TRUE - Karteikarte/Reiter neu zeichnen, FALSE sonst */void setAllObjectFlags(OBJECT *objectTree, WORD objectIdx, WORD objectFlags, BOOLEAN set, BOOLEAN children) {	WORD child, lastChild;	if (objectTree == NULL)		return;	child = objectTree[objectIdx].ob_head;	if ((child != NIL) && (children == TRUE)) {		setAllObjectFlags(objectTree, child, objectFlags, set, children);		/*		 * min. 1 Kind vorhanden und Kindobjekte sollen bearbeitet werden		 */		lastChild = objectTree[objectIdx].ob_tail;		while (child != lastChild) {			child = objectTree[child].ob_next;		}	}	setObjectFlags(objectTree, objectIdx, objectFlags, set);}#endif/** * Diese Methode liefert den Text, der in der Objekt-Struktur hinterlegt ist. Handelt es * sich um ein benutzerdefiniertes Objekt wird der Wert nur dann zurueck gegeben, wenn * es eines meiner Bibliothek ist. * * @param *objectTree Zeiger auf Objekt-Baum * @param objectIdx Objekt-Index des Text-Objekts im Objekt-Baum */BYTE *getObjectText(OBJECT *objectTree, WORD objectIdx) {	UBPARM *ubparm;	switch (objectTree[objectIdx].ob_type & 0xFF) {	case G_BOX:	case G_IBOX:	case G_BOXCHAR:		return ((BYTE *) objectTree[objectIdx].ob_spec.obspec.character);	case G_STRING:	case G_BUTTON:		return (objectTree[objectIdx].ob_spec.free_string);	case G_TEXT:	case G_BOXTEXT:	case G_FTEXT:	case G_FBOXTEXT:		return (objectTree[objectIdx].ob_spec.tedinfo->te_ptext);	case G_USERDEF:		ubparm = (UBPARM *) objectTree[objectIdx].ob_spec.userblk->ub_parm;		if (ubparm->magic == 'DIRK')			return (ubparm->text);	default:		return ("Dummy");	}}/** * */WORD setObjectText(OBJECT *objectTree, WORD objectIdx, BYTE *text) {	UBPARM *ubparm;	switch (objectTree[objectIdx].ob_type & 0xFF) {	case G_BOX:	case G_IBOX:	case G_BOXCHAR:		objectTree[objectIdx].ob_spec.obspec.character = text[0];		break;	case G_STRING:	case G_BUTTON:		strcpy(objectTree[objectIdx].ob_spec.free_string, text);		break;	case G_TEXT:	case G_BOXTEXT:	case G_FTEXT:	case G_FBOXTEXT:		strcpy(objectTree[objectIdx].ob_spec.tedinfo->te_ptext, text);		break;	case G_USERDEF:		ubparm = (UBPARM *) objectTree[objectIdx].ob_spec.userblk->ub_parm;		if (ubparm->magic == 'DIRK') {			ubparm->text = (BYTE *) realloc(ubparm->text, strlen(text) + 1);			if (ubparm->text == NULL)				return (USR_OUTOFMEMORY);			strcpy(ubparm->text, text);		}		break;	}	if ((objectTree[objectIdx].ob_type & 0xFF) != G_USERDEF)		return (USR_NOERROR);	ubparm = (UBPARM *) objectTree[objectIdx].ob_spec.userblk->ub_parm;	if (ubparm->magic == 'DIRK') {		ubparm->text = (BYTE *) realloc(ubparm->text, strlen(text) + 1);		if (ubparm->text == NULL)			return (USR_OUTOFMEMORY);		strcpy(ubparm->text, text);	}	return (USR_NOERROR);}/** * Mit dieser Methode kann man die Werte der Variablen 'ob_flags' eines Elements in der Objekt- * Struktur auf eine uebergebene Statusmaske testen. * * @param *objectTree Zeiger auf Objekt-Baum * @param objectIdx Objekt-Index des Objekts * @param objectFlags zu testende Statusmaske (ob_flags) des Objekts * @returns TRUE - Stati gesetzt ((ob_flags & objectFlags) != 0), FALSE - Stati nicht gesetzt ((ob_flags & objectFlags) == 0) */BOOLEAN getObjectFlags(OBJECT *objectTree, WORD objectIdx, BOOLEAN objectFlags) {	if (objectTree == NULL)		return (FALSE);	return (!!(objectTree[objectIdx].ob_flags & objectFlags));}/** * Mit dieser Methode kann man die Werte der Variablen 'ob_flags' eines Elements in der Objekt- * Struktur setzen oder loeschen. * * @param *objectTree Zeiger auf Objekt-Baum * @param objectIdx Objekt-Index des Objekts, dessen Werte gesetzt oder geloescht werden sollen * @param ob_flags der zu setzende oder loeschende Wert * @param set TRUE - setzen, FALSE loeschen */void setObjectFlags(OBJECT *objectTree, WORD objectIdx, WORD objectFlags, BOOLEAN set) {	if (objectTree == NULL)		return;	if (set == TRUE)		objectTree[objectIdx].ob_flags |= objectFlags;	else		objectTree[objectIdx].ob_flags &= ~objectFlags;}/** * Mit dieser Methode kann man die Werte der Variablen 'ob_state' eines Elements in der Objekt- * Struktur auf eine uebergebene Statusmaske testen. * * @param *objectTree Zeiger auf Objekt-Baum * @param objectIdx Objekt-Index des Objekts * @param objectState zu testende Statusmaske (ob_state) des Objekts * @returns TRUE - Stati gesetzt ((ob_state & objectState) != 0), FALSE - Stati nicht gesetzt ((ob_state & objectState) == 0) */BOOLEAN getObjectState(OBJECT *objectTree, WORD objectIdx, BOOLEAN objectState) {	if (objectTree == NULL)		return (FALSE);	return (!!(objectTree[objectIdx].ob_state & objectState));}/** * Mit dieser Methode kann man die Werte der Variablen 'ob_state' eines Elements in der Objekt- * Struktur auf den Status SELECTED testen. * * @param *objectTree Zeiger auf Objekt-Baum * @param objectIdx Objekt-Index des Objekts * @returns TRUE - Objekt selektiert, FALSE - sonst */BOOLEAN isObjectSelected(OBJECT *objectTree, WORD objectIdx) {	return (getObjectState(objectTree, objectIdx, SELECTED));}/** * Mit dieser Methode kann man die Werte der Variablen 'ob_state' eines Elements in der Objekt- * Struktur setzen oder loeschen. * * @param *objectTree Zeiger auf Objekt-Baum * @param objectIdx Objekt-Index des Objekts, dessen Werte gesetzt  werden sollen * @param objectState die zu setzenden Werte * @param set TRUE - objectState wird gesetzt, FALSE - objectState wird geloescht */void setObjectState(OBJECT *objectTree, WORD objectIdx, WORD objectState, BOOLEAN set) {	if (objectTree == NULL)		return;	if (set == TRUE)		objectTree[objectIdx].ob_state |= objectState;	else		objectTree[objectIdx].ob_state &= ~objectState;}#if 0/** * Mit dieser Methode kann man die Werte der Variablen 'ob_state' eines Elements in der Objekt- * Struktur setzen. * * @param *tree Zeiger auf Objekt-Baum * @param objectIdx Objekt-Index des Objekts, dessen Werte gesetzt  werden sollen * @param objectState die zu setzenden Werte */void setObjectState(OBJECT *objectTree, WORD objectIdx, WORD objectState) {	if (objectTree == NULL)		return;	setObjectState(objectTree, objectIdx, objectState, TRUE);}/** * Mit dieser Methode kann man die Werte der Variablen 'ob_state' eines Elements in der Objekt- * Struktur loeschen. * * @param *tree Zeiger auf Objekt-Baum * @param objectIdx Objekt-Index des Objekts, dessen Werte geloescht werden sollen * @param objectState die zu loeschenden Werte */void unsetObjectState(OBJECT *objectTree, WORD objectIdx, WORD objectState) {	if (objectTree == NULL)		return;	setObjectState(objectTree, objectIdx, objectState, FALSE);}#endif